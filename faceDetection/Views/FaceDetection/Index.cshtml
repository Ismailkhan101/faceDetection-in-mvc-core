@{
    ViewData["Title"] = "Face Detection";
}

<h2>Face Detection</h2>

<form id="uploadForm" enctype="multipart/form-data">
    <input type="file" name="image" accept="image/*" />
    <button type="submit">Detect Faces</button>
</form>

<div id="result">
    <img id="resultImage" style="display:none; max-width: 100%;" />
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#uploadForm').submit(function (e) {
                e.preventDefault();
                var formData = new FormData(this);

                $.ajax({
                    url: '@Url.Action("DetectFaces", "FaceDetection")',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    xhr: function () {
                        var xhr = new XMLHttpRequest();
                        xhr.responseType = 'blob';
                        return xhr;
                    },
                    success: function (data) {
                        var url = window.URL || window.webkitURL;
                        var imageUrl = url.createObjectURL(data);
                        $('#resultImage').attr('src', imageUrl).show();
                    },
                    error: function () {
                        alert('An error occurred during face detection.');
                    }
                });
            });
        });
    </script>
}